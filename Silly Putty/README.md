# Silly Putty 
![image](https://user-images.githubusercontent.com/102762345/189479117-d8fc4a16-b442-4182-94e3-0eba97d8970c.png)

Hello Analyst,

The help desk has received a few calls from different IT admins regarding the attached program.They say that they've been using this program with no problems until recently. Now, it's crashing randomly and popping up blue windows when its run. I don't like the sound of that.

# Task 
Perform Basic static and basic dynamic analysis on this malware sample and extract facts about the malware's behavior.

# Static Analysis

***
To begin with I started my windows vm with caution. I made sure that my NAT adapter is disabled and my host adapter is running with no access to the 
internet. 
***

SHA256 HASH --> 0c82e654c09c8fd9fdf4899718efa37670974c9eec5a8fc18a167f93cea6ee83


CPU Architecture --> 32-bit executable


Magic Byte --> 4D 5A 


Submitting the Hash to VirusTotal there was some intersting results that are listed below


![image](https://user-images.githubusercontent.com/102762345/189479506-fedaf8b1-8696-4368-a0bf-d27030c021b9.png)


This tells us that this specific sample has been seen in the wild before.


Running Floss and Strings on the executable did not give me any results,


Infact not single string even looked suspicous enough as it looks as a regular program.


Also Note that the binary is not packed. We can tell by looking down on

As the Virtual Size and Size of Raw Data is nearly the same

Virtual Size:
00095F6D - 614253

Size of Raw Data
00096000 - 614400

I did not find any library imports that could instantly flag this binary as malicious, 
everything seemed normal to me.

# Dynamic Analysis

First-Detonation && First Look Without Internet Simulation and with.

After arming the binary, i was ready to detonate it for the first time, when i executed malware, a powershell window popped up and instantly closed,
following that basic putty screen opened as it's supposed to. After running it once again but this time with INETSIM the output was the same and 
there was no signs of new indicators

# Host Based Indicators

After running procmon to look for any suspicous host base indicators, i found a "Process Create" Operation that has a powershell call 
within puttys child processes.

![image](https://user-images.githubusercontent.com/102762345/189481285-297a3c61-5a05-4942-88ac-412afc6a0e23.png)

Below is another image that does not include the process tree.

![image](https://user-images.githubusercontent.com/102762345/189481197-bd94b7a3-5a08-44c0-bc94-f2fc29abb09d.png)

# Network Based Indicators

Capturing local network trafic with wireshark i saw a DNS Query to a domain

![image](https://user-images.githubusercontent.com/102762345/189480788-4fb906fa-a425-4820-952b-648f8315b1a0.png)

** bonus2.corporatebonusapplication.local **

On top of that i ended up finding the callback port after the detonation 
this can be useful in the next step if we try to put up a reverse shell.
The port is 8443 which is an "Apache Tomcat HTTPS"

![image](https://user-images.githubusercontent.com/102762345/189481497-4f6d87af-2470-4956-8218-0f6deee2f550.png)

With that information and more packet analysis the callback protocol is,
SSL/TLS this was identified with the CLIENT HELLO message.

The next step for me was to try to put a reverse shell on the malware,
thought it did not work as it uses tls and a regular netcat shell did not work with it.

![image](https://user-images.githubusercontent.com/102762345/189482818-adbcd21f-7271-4766-9af8-e967c7fbeed3.png)

