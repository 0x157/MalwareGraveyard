
<h1 align="center">
  𝓜𝓪𝓵𝓲𝓬𝓲𝓸𝓾𝓼 𝓓𝓸𝓬𝓾𝓶𝓮𝓷𝓽 𝓐𝓷𝓪𝓵𝔂𝓼𝓲𝓼
</h1>

<p align="center">
  <img height="340" width="310" src="https://user-images.githubusercontent.com/102762345/194019661-265cf9bf-935e-4c1a-8a03-4fc8c9923c07.png">
  <img height="340" width="310" src="https://user-images.githubusercontent.com/102762345/194019312-b60cdbd8-9dd7-4a11-ac76-6878e1a1382d.png">
</p>

<h1 align="center">
  𝓢𝓽𝓪𝓻𝓽𝓲𝓷𝓰 𝓦𝓲𝓽𝓱 𝓔𝔁𝓬𝓮𝓵 𝓜𝓪𝓵𝓓𝓸𝓬
</h1>


The initial analysis began with making sure everything was safe in the lab: Check's Performed --> NAT Adapter Disabled and Inetsim OFF.

I started a python3 http server to transfer the sample over to my remnux box, after the sample was transfered succesfully i took a note that the

file extension was .xlsm which means that the document had developer macros enabled. The Next Part of the Analysis was to unzip it and run 

oledump against the sample. This Was the output.

<img src="https://user-images.githubusercontent.com/102762345/194021862-d76ced5c-6668-41ab-aa7f-aaff3a0ecfae.png">

The `M` means that, the VBA/Module1 is the one that has a certain script enabled within itself. After running another oledump command that let me 

look for strings, there was few intersting result's. As we can see below there is a specific domain and a cmd command that opens powershell 

and execute's `.\run.ps1`

<img src="https://user-images.githubusercontent.com/102762345/194022784-f5255577-7022-4986-b256-822ac4c2ee4b.png">

We have enough information to work with after i tried to fully decompress the vba macro and can develop hypothosis. 

<img src="https://user-images.githubusercontent.com/102762345/194024319-bd510a2c-c96c-47a8-8bd0-a5707bf22d91.png">

As we can see that the macro was given to us just how we would want it, there are a few key components to keep an eye out for , one being  

the HTTP - GETrequest to a domain and another major one being the Shell call. What might be happening is once the macro is ran, 

we reach out to the link and download  the needed string, once we do that we execute cmd and call for the 32 bit powershell 

with specific parameter being `-W Hidden` which means execute with a hidden window. 



